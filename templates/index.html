<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>YOLO Multi-Class Annotator</title>
    <link rel="stylesheet" href="/static/styles.css?v=2024-augment">
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸ¯ YOLO Multi-Class Annotator
            <button id="helpBtn" class="help-btn" title="Ver instrucciones">â“</button>
        </h1>
        
        <!-- â­ PANEL DE HERRAMIENTAS AVANZADAS â­ -->
        <div id="advanced-tools" style="
            text-align: center; 
            margin: 20px auto; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            border-radius: 15px; 
            border: 3px solid #4834d4;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            max-width: 800px;
        ">
            <h2 style="
                margin: 0 0 20px 0; 
                color: white; 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                font-size: 24px;
            ">ğŸš€ HERRAMIENTAS AVANZADAS</h2>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="/sessions" target="_blank" style="
                    background: linear-gradient(45deg, #28a745, #20c997); 
                    color: white; 
                    text-decoration: none; 
                    padding: 15px 20px; 
                    border-radius: 10px; 
                    font-weight: bold;
                    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
                    border: 2px solid #ffffff50;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸ“‚ GESTIONAR SESIONES
                </a>
                
                <a href="/real-sessions" target="_blank" style="
                    background: linear-gradient(45deg, #ffc107, #fd7e14); 
                    color: #333; 
                    text-decoration: none; 
                    padding: 15px 20px; 
                    border-radius: 10px; 
                    font-weight: bold;
                    box-shadow: 0 4px 15px rgba(255, 193, 7, 0.6);
                    border: 3px solid #ff8c00;
                    font-size: 16px;
                    text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
                    animation: pulse-glow 2s infinite;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='translateY(-2px) scale(1.05)'" onmouseout="this.style.transform='translateY(0) scale(1)'">
                    ğŸ”„ AUGMENTAR DATASET â­
                </a>
                
                <a href="/visualizer" target="_blank" style="
                    background: linear-gradient(45deg, #17a2b8, #138496); 
                    color: white; 
                    text-decoration: none; 
                    padding: 15px 20px; 
                    border-radius: 10px; 
                    font-weight: bold;
                    box-shadow: 0 4px 15px rgba(23, 162, 184, 0.4);
                    border: 2px solid #ffffff50;
                    transition: all 0.3s ease;
                " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸ‘ï¸ VISUALIZADOR
                </a>
            </div>
            
            <p style="
                color: white; 
                margin: 15px 0 0 0; 
                font-size: 14px; 
                opacity: 0.9;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            ">
                ğŸ’¡ Usa estas herramientas para gestionar tus datasets y aplicar augmentaciones
            </p>
        </div>

        <style>
            @keyframes pulse-glow {
                0%, 100% { 
                    box-shadow: 0 4px 15px rgba(255, 193, 7, 0.6), 0 0 20px rgba(255, 140, 0, 0.3); 
                }
                50% { 
                    box-shadow: 0 4px 20px rgba(255, 193, 7, 0.8), 0 0 30px rgba(255, 140, 0, 0.5); 
                }
            }
        </style>
        
        <!-- Modal de Instrucciones -->
        <div id="instructionsModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>ğŸ“š Instrucciones de Uso</h2>
                <div class="instructions-content">
                    <h3>ğŸš€ Pasos para anotar:</h3>
                    <ol>
                        <li><strong>ğŸ“¤ Sube tu imagen</strong> - Formatos soportados: JPG, PNG, WebP, GIF, BMP</li>
                        <li><strong>âš™ï¸ Configura parÃ¡metros</strong> - TamaÃ±o del canvas, posiciÃ³n, fondo</li>
                        <li><strong>ğŸ–¼ï¸ Genera el canvas</strong> - Click en "Generar" para crear el lienzo</li>
                        <li><strong>ğŸ¯ Selecciona una clase</strong> - Elige el tipo de objeto a anotar</li>
                        <li><strong>ğŸ–±ï¸ Arrastra para anotar</strong> - Crea bounding boxes sobre los objetos</li>
                        <li><strong>ğŸ”„ Repite para mÃºltiples objetos</strong> - Anota todos los objetos de la imagen</li>
                        <li><strong>ğŸ’¾ Guarda las anotaciones</strong> - Formato YOLO estÃ¡ndar para entrenamiento</li>
                    </ol>
                    <h3>ğŸ¨ Clases disponibles:</h3>
                    <div class="classes-preview">
                        <div class="class-item"><span style="background: #ff0000;"></span> Objeto 1</div>
                        <div class="class-item"><span style="background: #00ff00;"></span> Objeto 2</div>
                        <div class="class-item"><span style="background: #0000ff;"></span> Objeto 3</div>
                        <div class="class-item"><span style="background: #ffff00;"></span> Objeto 4</div>
                        <div class="class-item"><span style="background: #ff00ff;"></span> Objeto 5</div>
                        <div class="class-item"><span style="background: #00ffff;"></span> Objeto 6</div>
                    </div>
                    <h3>âš¡ Atajos de teclado:</h3>
                    <ul>
                        <li><kbd>1-6</kbd> - Seleccionar clase rÃ¡pida</li>
                        <li><kbd>Escape</kbd> - Cancelar anotaciÃ³n actual</li>
                        <li><kbd>Delete</kbd> - Eliminar anotaciÃ³n seleccionada</li>
                    </ul>
                    <h3>ğŸ“ GestiÃ³n de sesiones:</h3>
                    <ul>
                        <li><strong>ğŸ’¾ Descargar:</strong> ObtÃ©n un ZIP con formato YOLO listo para entrenar</li>
                        <li><strong>ğŸ‘ï¸ Visualizar:</strong> Ve todas las anotaciones en galerÃ­a</li>
                        <li><strong>ï¿½ Augmentar:</strong> Multiplica tu dataset con variantes de imÃ¡genes</li>
                        <li><strong>ï¿½ğŸ—‘ï¸ Eliminar:</strong> Borra sesiÃ³n completa (irreversible)</li>
                    </ul>
                    <h3>ğŸ¨ AugmentaciÃ³n de Dataset:</h3>
                    <ul>
                        <li><strong>Negativo:</strong> Invierte colores de las imÃ¡genes</li>
                        <li><strong>Brillo:</strong> Aumenta luminosidad 50%</li>
                        <li><strong>Espejo:</strong> Volteo horizontal (ajusta etiquetas YOLO automÃ¡ticamente)</li>
                        <li><strong>RotaciÃ³n:</strong> Gira imÃ¡genes 15 grados</li>
                        <li><strong>Desenfoque:</strong> Aplica filtro gaussiano suave</li>
                        <li><strong>Contraste:</strong> Aumenta contraste 30%</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Panel principal -->
        <div class="two-column">
            <div class="main-panel">
                <!-- Formulario de carga de imagen -->
                <form id="imageForm" enctype="multipart/form-data">
                    <div class="controls">
                        <div class="control-group">
                            <label for="sessionName">SesiÃ³n:</label>
                            <input type="text" id="sessionName" name="session_name" placeholder="Nombre de sesiÃ³n" value="default">
                            <button type="button" id="refreshSessions">ğŸ”„</button>
                        </div>
                        
                        <div class="control-group">
                            <label for="imageFile">Imagen:</label>
                            <input type="file" id="imageFile" name="image" accept="image/*" required>
                            <small style="color: #666; font-size: 12px;">
                                Soporta: JPG, PNG, WebP, GIF, BMP (se redimensiona automÃ¡ticamente)
                            </small>
                        </div>
                        
                        <div class="control-group">
                            <label for="size">TamaÃ±o:</label>
                            <select id="size" name="size">
                                <option value="320">320x320</option>
                                <option value="640">640x640</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="xPos">Pos X:</label>
                            <input type="range" id="xPos" name="x" min="0" max="640" value="0">
                            <span id="xValue">0</span>
                        </div>
                        
                        <div class="control-group">
                            <label for="yPos">Pos Y:</label>
                            <input type="range" id="yPos" name="y" min="0" max="640" value="0">
                            <span id="yValue">0</span>
                        </div>
                        
                        <div class="control-group">
                            <label>
                                <input type="checkbox" id="randomBg" name="random_bg" checked> Fondo aleatorio
                            </label>
                        </div>
                        
                        <button type="submit">ğŸ–¼ï¸ Generar</button>
                    </div>
                </form>

                <!-- Canvas de imagen -->
                <canvas id="imageCanvas" style="display: none; border: 1px solid #ddd; margin-top: 20px; cursor: crosshair;"></canvas>
                
                <!-- Controles de anotaciÃ³n -->
                <div id="annotationControls" style="display: none; margin-top: 20px;">
                    <h3>ğŸ¯ Seleccionar Clase:</h3>
                    <div id="classButtons" class="class-buttons"></div>
                    
                    <h3>ğŸ“ Anotaciones:</h3>
                    <div id="annotationsList" class="annotations-list">
                        <p>Sin anotaciones aÃºn</p>
                    </div>
                    
                    <div class="annotation-actions">
                        <input type="text" id="filename" placeholder="Nombre del archivo" style="margin-right: 10px; padding: 8px;">
                        <button onclick="saveAnnotations()" class="save-btn">ğŸ’¾ Guardar</button>
                        <button onclick="clearAnnotations()" class="clear-btn">ğŸ—‘ï¸ Limpiar</button>
                    </div>
                </div>
            </div>

            <!-- Panel de sesiones -->
            <div class="sessions-panel">
                <h3>ğŸ“‚ Sesiones</h3>
                <div id="sessionsList"></div>
                <button onclick="refreshSessions()" class="save-btn" style="width: 100%; margin-top: 10px;">ğŸ”„ Actualizar</button>
            </div>
        </div>
    </div>
    
    <script src="/static/application.js"></script>
    <script src="/static/main.js"></script>
</body>
</html>
